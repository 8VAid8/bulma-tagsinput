!function(e,t){if("function"==typeof define&&define.amd)define(["exports"],t);else if("undefined"!=typeof exports)t(exports);else{var i={};t(i),e.bulmaTagsinputMin=i}}(this,function(e){"use strict";function t(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(e),n=1;n<arguments.length;n++){var a=arguments[n];if(null!=a)for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(i[s]=a[s])}return i},writable:!0,configurable:!0});var i=["click","touchstart"],n=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);this.element=t,this.options=Object.assign({},{disabled:!1,delimiter:",",allowDelete:!0,lowercase:!1,uppercase:!1,duplicates:!0},i),this.init()}var n,a,s;return n=e,(a=[{key:"init",value:function(){if(!this.options.disabled){this.tags=[],this.container=document.createElement("div"),this.container.className="tagsinput",this.container.classList.add("field"),this.container.classList.add("is-grouped"),this.container.classList.add("is-grouped-multiline"),this.container.classList.add("input");var e=this.element.getAttribute("type");e&&"tags"!==e||(e="text"),this.input=document.createElement("input"),this.input.setAttribute("type",e),this.element.getAttribute("placeholder")?this.input.setAttribute("placeholder",this.element.getAttribute("placeholder")):this.input.setAttribute("placeholder","Add a Tag"),this.container.appendChild(this.input);var t=this.element.nextSibling;this.element.parentNode[t?"insertBefore":"appendChild"](this.container,t),this.element.style.cssText="position:absolute;left:0;top:0;width:1px;height:1px;opacity:0.01;",this.element.tabIndex=-1,this.enable()}}},{key:"enable",value:function(){var e=this;this.enabled||this.options.disabled||(this.element.addEventListener("focus",function(){e.container.classList.add("is-focused"),e.select(Array.prototype.slice.call(e.container.querySelectorAll(".tag:not(.is-delete)")).pop())}),this.input.addEventListener("focus",function(){e.container.classList.add("is-focused"),e.select(Array.prototype.slice.call(e.container.querySelectorAll(".tag:not(.is-delete)")).pop())}),this.input.addEventListener("blur",function(){e.container.classList.remove("is-focused"),e.select(Array.prototype.slice.call(e.container.querySelectorAll(".tag:not(.is-delete)")).pop()),e.savePartial()}),this.input.addEventListener("keydown",function(t){var i,n=t.charCode||t.keyCode||t.which,a=e.container.querySelector(".tag.is-active"),s=Array.prototype.slice.call(e.container.querySelectorAll(".tag:not(.is-delete)")).pop(),r=e.caretAtStart(e.input);if(a&&(i=e.container.querySelector('[data-tag="'+a.innerHTML.trim()+'"]')),e.setInputWidth(),13===n||n===e.options.delimiter.charCodeAt(0)||188===n||9===n){if(!e.input.value&&(n!==e.options.delimiter.charCodeAt(0)||188===n))return;e.savePartial()}else if(46===n&&i)i.nextSibling?e.select(i.nextSibling.querySelector(".tag")):i.previousSibling&&e.select(i.previousSibling.querySelector(".tag")),e.container.removeChild(i),delete e.tags[e.tags.indexOf(i.getAttribute("data-tag"))],e.setInputWidth(),e.save();else if(8===n)if(i)i.previousSibling?e.select(i.previousSibling.querySelector(".tag")):i.nextSibling&&e.select(i.nextSibling.querySelector(".tag")),e.container.removeChild(i),delete e.tags[e.tags.indexOf(i.getAttribute("data-tag"))],e.setInputWidth(),e.save();else{if(!s||!r)return;e.select(s)}else if(37===n)if(i)i.previousSibling&&e.select(i.previousSibling.querySelector(".tag"));else{if(!r)return;e.select(s)}else{if(39!==n)return e.select();if(!i)return;e.select(i.nextSibling.querySelector(".tag"))}return t.preventDefault(),!1}),this.input.addEventListener("input",function(){e.element.value=e.getValue(),e.element.dispatchEvent(new Event("input"))}),this.input.addEventListener("paste",function(){return setTimeout(savePartial,0)}),this.container.addEventListener("mousedown",function(t){e.refocus(t)}),this.container.addEventListener("touchstart",function(t){e.refocus(t)}),this.savePartial(this.element.value),this.enabled=!0)}},{key:"disable",value:function(){this.enabled&&!this.options.disabled&&(this.reset(),this.enabled=!1)}},{key:"select",value:function(e){var t=this.container.querySelector(".is-active");t&&t.classList.remove("is-active"),e&&e.classList.add("is-active")}},{key:"addTag",value:function(e){var t=this;if(~e.indexOf(this.options.delimiter)&&(e=e.split(this.options.delimiter)),Array.isArray(e))return e.forEach(function(e){t.addTag(e)});var n=e&&e.trim();if(!n)return!1;if((this.element.getAttribute("lowercase")||"true"==this.options.lowercase)&&(n=n.toLowerCase()),(this.element.getAttribute("uppercase")||"true"==this.options.uppercase)&&(n=n.toUpperCase()),"true"==this.element.getAttribute("duplicates")||this.options.duplicates||-1===this.tags.indexOf(n)){this.tags.push(n);var a=document.createElement("div");a.className="control",a.setAttribute("data-tag",n);var s=document.createElement("div");s.className="tags",s.classList.add("has-addons");var r=document.createElement("span");if(r.className="tag",r.classList.add("is-active"),this.select(r),r.innerHTML=n,s.appendChild(r),this.options.allowDelete){var l=document.createElement("a");l.className="tag",l.classList.add("is-delete"),i.forEach(function(e){l.addEventListener(e,function(e){var i,n=e.target.parentNode,a=Array.prototype.slice.call(t.container.querySelectorAll(".tag")).pop(),s=t.caretAtStart(t.input);if(n&&(i=t.container.querySelector('[data-tag="'+n.innerText.trim()+'"]')),i)t.select(i.previousSibling),t.container.removeChild(i),delete t.tags[t.tags.indexOf(i.getAttribute("data-tag"))],t.setInputWidth(),t.save();else{if(!a||!s)return;t.select(a)}})}),s.appendChild(l)}a.appendChild(s),this.container.insertBefore(a,this.input)}}},{key:"getValue",value:function(){return this.tags.join(this.options.delimiter)}},{key:"setValue",value:function(e){var t=this;Array.prototype.slice.call(this.container.querySelectorAll(".tag")).forEach(function(e){delete t.tags[t.tags.indexOf(e.innerHTML)],t.container.removeChild(e)}),this.savePartial(e)}},{key:"setInputWidth",value:function(){var e=Array.prototype.slice.call(this.container.querySelectorAll(".control")).pop();this.container.offsetWidth&&(this.input.style.width=Math.max(this.container.offsetWidth-(e?e.offsetLeft+e.offsetWidth:30)-30,this.container.offsetWidth/4)+"px")}},{key:"savePartial",value:function(e){"string"==typeof e||Array.isArray(e)||(e=this.input.value),!1!==this.addTag(e)&&(this.input.value="",this.save(),this.setInputWidth())}},{key:"save",value:function(){this.element.value=this.tags.join(this.options.delimiter),this.element.dispatchEvent(new Event("change"))}},{key:"caretAtStart",value:function(e){try{return 0===e.selectionStart&&0===e.selectionEnd}catch(t){return""===e.value}}},{key:"refocus",value:function(e){return e.target.classList.contains("tag")&&this.select(e.target),e.target===this.input?this.select():(this.input.focus(),e.preventDefault(),!1)}},{key:"reset",value:function(){this.tags=[]}},{key:"destroy",value:function(){this.disable(),this.reset(),this.element=null}}])&&t(n.prototype,a),s&&t(n,s),e}();e.default=n,document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll('input[type="tags"]');[].forEach.call(e,function(e){new n(e)})})});